# Introduction to R {#app-rintro}

## Why R?

For conducting analyses with data sets of hundreds to thousands of observations, calculating by hand is not feasible and you will need a statistical software. **R** is one of those. R can also be thought of as a high-level programming language. In fact, **R** is one of the [top languages](https://statisticstimes.com/tech/top-computer-languages.php) to be used by data analysts and data scientists. There are a lot of analysis packages in **R** that are currently developed and maintained by researchers around the world to deal with different data problems. And most importantly, **R** is **free**. In this book, we will learn how to use R to conduct basic statistical analyses.

## Installing R and RStudio

To install R, go to the following link: [https://www.r-project.org/](https://www.r-project.org/). You can choose the CRAN closest to your location.

To work with R more easily, download RStudio, an interface software for R, from the following link: [https://www.rstudio.com/products/rstudio/download/](https://www.rstudio.com/products/rstudio/download/). The free version is good enough for our use. 

After downloading, install R and RStudio on your computer. 

## The RStudio Interface

When you open RStudio, the below window will pop up.

```{r rintro-rstudio, out.width="80%", fig.cap="RStduio windows", echo = FALSE, fig.align="center"}
knitr::include_graphics(paste0(fig.path, "app-rintro/RStudio.PNG"))
```

Notice that there are four panels in the RStudio window.

1. **Source code panel**: This is where we write scripts that contains codes to be saved for later use. You can create a new **R** script by clicking the white button below **File** and choose **R Script**.

2. **Console panel**: This is where we execute the codes (in our script) interactively and where we see the **printed output** of the code. We can run our code by

    - selecting the code in our script and click run, or

    - typing or pasting the code in the console,

then hit <kbd>Enter</kbd>. The output of our code will appear in the console.

3. **Environment panel**: 

    - The **Environment** tab shows the active datasets or variables that are currently saved in **R**'s working memory. 
    
    - The **History** tab keeps track of every single line of code that has been entered and run through the console. 

4. **The Files, Plots, Packages, Help and Viewer panel**: 

    - The **Plots** tab shows the plots (or graphs) that we create using our code. 
    
    - The **Files** tab keep track of the files in our working directory. 
    
    - The **Packages** tab will show available packages in our local **R** library. 
    
    - The **Help** tab will show documentation about the packages or functions if we ask.
    
## Helper Codes

### Packages

In **R**, packages contain functions that will become handy when you conduct data analyses. You can view the available CRAN packages in your library or search for a specific package in the **Packages** tab. 

To install packages in R, you can run the code
```{r rintro-install, eval=FALSE}
install.packages("packagename")
```
replacing `packagename` by the name of the package.

Once a package is installed we need to load them in order to use their functions using the code
```{r rintro-library, eval=FALSE}
library(packagename)
```
Note that a package is only installed **once** but needs to be loaded **every time** we want to use its functions.

### Getting Help {#rintro-sec-help}

`install.packages()` and `library()` are functions in **R**. To understand the functionality of any built-in function or any function from a loaded package, run the following command in the console
```{r rintro-help, eval=FALSE}
?functionname
```
with `functionname` replaced by the name of the function.

For example, if we run
```{r rintro-help-2, eval=FALSE}
?install.packages
```
in the console, the **Help** tab will open with information about the function `install.packages()`.

You can also search for the name of the function you want to understand more about in the *Search* bar of the **Help** tab.

### Leaving Comments

It is good practice to always have some comments to provide brief explanations about what your code is intended to do. Your code script will be more organized in this way. To indicate that a line is a comment, (not code), and should not be run in a script, use the hashtag/sharp/pound key \#. For example
```{r rintro-comment, eval=FALSE}
# This is a comment and will not run!
```

## Basic Calculations

As **R** will help us to analyze the data, it is able to handle many calculations. Try typing the code below in the console and hit <kbd>Enter</kbd>,  you will see the calculated result printed in the console.

1. **Addition**

```{r rintro-add}
20+22
```

2. **Subtraction**

```{r rintro-subtract}
20-22
```

3. **Multiplication**

```{r rintro-multiplication}
20*22
```

4. **Division**

```{r rintro division}
20/22
```

5. **Power**

```{r rintro-power}
5^4
```

or you can also write

```{r rintro-power-2}
5**4
```

6. **Combining the operations**

```{r rintro-combine}
(5^4)+(20/22)-(20-22)
```

7. **Taking the square root**

```{r rintro-sqrt}
sqrt(5)
```

8. **Natural log**

```{r rintro-log}
log(5)
```

or log base 10

```{r rintro-log-10}
log(5, 10)
```

9. **Exponent**

```{r rintro-exp}
exp(5)
```

10. **Round** to 2 decimal places

```{r rintro-round}
round(log(5), 2)
```

::: {.myExercise}
::: {.exercise #exr-rintro-calculation}
Calculate the following expression using R
\[8^4 \times 12- \lfloor 247 \times \log(10)/1.25 \rfloor\]
**Hints**: $\lfloor x \rfloor$ returns the largest integer less than $x$. Try looking up functions `floor()` using instructions from Section [A.4.2](#rintro-sec-help).  
:::
:::

## Objects 

You can save the values of any of the above calculations to objects in R using the `<-` or `=` operator.  For example, if you run the following code
```{r rintro-object}
three <- 3
```
Then, in the **Environment** tab, an object called `three` will appear with value 3. You can use this object for later calculation. For example, 
```{r rintro-object-calculate}
three + 10
```
will give 13 in the console. 

Object is an important concept in **R** or in any programming language. It can contain different types of information, such as a value (i.e., atomic vector), a vector, a matrix, a data frame, a list, or a function, etc. We will get more familiar to this as we go. 

You can almost freely name an object using any string of characters so that:

- The string can contain word characters, numbers, no space, and no special characters except for dot `.` and underscore `_`.

- The name should not start with a number or a special character.

- Give informative names so that you can recall what this object is when you read the code later. 

- Avoid using the same name with R built-in values (e.g., `pi`) or functions (e.g., `round`). 

- R differentiate between capital and lowercase letters in object names. So objects `Three` and `three` can refer to different objects in R. 

## Vectors

### Vector Creation

Vectors contain one or more values. You can create vectors using

- `c()`: function to create a vector by listing its values 

- `rep()`: function to repeat values of a vector 

- `seq()`: create equally-spaced sequences of number. 

Try looking these functions up following instruction in Section [A.4.2](#rintro-sec-help).

::: {.myExample}
::: {.example}
Create the vector $\mathbf{x} = (-1,0,1)$:
```{r rintro-c}
x <- c(-1,0,1)
```
Now object `x` stores the vector $(-1,0,1)$. We can print the value of `x`:
```{r rintro-c-print}
x
```
:::
:::

::: {.empty}
:::

::: {.myExample}
::: {.example}
Create a sequence of numbers from 0 to 10 jumping in units of two (i.e., 0,2,4,6,8,10) then store it in an object called `y`:
```{r rintro-seq}
y <- seq(0, 10, by=2)
y
```
:::
:::

::: {.empty}
:::

::: {.myExample}
::: {.example}
Create a sequence of numbers from 0 to 10 jumping in units of two that repeats twice:
```{r rintro-rep}
y <- rep(seq(0,10,by=2),2)
y
```
:::
:::

::: {.empty}
:::

::: {.myExample}
::: {.example}
You can also store qualitative values (as characters) into vectors in **R**
```{r rintro-char}
color1 <- c("red", "blue", "green")
color1
color2 <- rep(color1, each = 2)
color2
```
:::
:::

### Vector Operations

You can perform mathematical operations on the vector. For example,
```{r rintro-vec-calculate}
x <- c(-1,0,1)
y <- c(2,4,6)
z <- x + y
z
```
will give the element-wise sum of the two vectors `x` and `y`.

```{r rintro-length}
length(x)
```
will give the number of values (length) of vector `x`.

```{r rintro-sum}
sum(x)
```
will give the sum of the elements of vector `x`.

### Extracting Elements from Vectors

::: {.myExample}
::: {.example}
Create a vector `x` that contains numbers 1 to 11
```{r rintro-extract-vec-1}
x <- seq(1,11,by=1)
```
Create another vector `y` that contains numbers 2 to 30
```{r rintro-extract-vec-2}
y <- seq(2,30,by=1)
```
Join the two vectors together
```{r rintro-extract-vec-3}
z <- c(x,y)
z
```

What if we now want to extract certain values from this new vector `z`?
```{r rintro-extract-vec-4}
z[22]
```
returns the 22nd element of vector `z`. 
```{r rintro-extract-vec-5}
z[4:8]
```
returns the fourth to eighth elements in the vector `z`.
```{r rintro-extract-vec-6}
z[c(4,8)]
```
returns the the fourth and the eighth elements in to vector `z`.

Negative indices can be used to **remove** certain elements
```{r rintro-extract-vec-7}
z[-2]
```
returns a the same vector as `z` but with the second element removed. The third to eleventh elements of `z` can be skipped using
```{r rintro-extract-vec-8}
z[-(3:11)]
```

Do not mix positive and negative indices. Consider
```{r rintro-extract-vec-9,eval=FALSE}
z[c(-2,3)]
```
which will throw an error. 
:::
:::

## Data Sets

### Data Frame

A data frame consists of columns that are vectors. You can group the vectors together to create a data set using the `data.frame()` function.

::: {.myExample}
::: {.example}
```{r rintro-df}
x <- c(-1,0,1)
y <- c(2,4,6)
datset <- data.frame(x,y)
datset
```
:::
:::

### Load Data Files

Suppose that your data is saved in a file called `r embed_data_file("data/dataset/mydata.txt")`. You can import the dataset into **R** environment. 
```{r eval=FALSE, echo=TRUE}
mydata <- read.table("mydata.txt", header=TRUE)
```
```{r rintro-load, echo=FALSE, eval=TRUE}
mydata <- read.table("data/dataset/mydata.txt", header=TRUE)
```
The argument `header=TRUE` tells **R** to use the first line in the text file as the names of the columns. If the column headings are not included in the file, the argument can be omitted. 

Now, the `mydata.txt` data set is loaded into **R** environment and is saved as a **data-frame** object called `mydata`. We can then work with this data set using **R**. 

- You can view the dataset using the command
    
    ```{r rintro-view, eval=FALSE}
View(mydata)
    ```

- You can also print the first 6 lines of the dataset in the console using the command
  
    ```{r rintro-head}
head(mydata)
    ```

- The names of the columns can be printed in the console by the command
    
    ```{r rintro-names}
names(mydata)
    ```
    or
    ```{r rintro-colnames}
colnames(mydata)
    ```
    
**R** can also import other data formats, such as excel or csv. Try looking up the functions `read.csv()` and `read.table()` using instruction from Section [A.4.2](#rintro-sec-help).

To load a data set using RStudio options:
```{r rintro-load-rstudio, out.width="80%", fig.cap="Importing Datasets in RStudio", echo = FALSE, fig.align="center"}
knitr::include_graphics(paste0(fig.path, "app-rintro/loadDataset.PNG"))
```

### Working Directory

Your data file can be anywhere in the computer. To load the file correctly you need to specify the directory where the file is saved. For example, if it is saved in drive C:
```{r rintro-setwd-1, eval=FALSE}
mydata <- read.table("C:/mydata.txt", header=TRUE)
```

To use this command 
```{r rintro-setwd-2, eval=FALSE}
mydata <- read.table("mydata.txt", header=TRUE)
```
i.e., to load the data without specifying the full directory, you need to set the working directory to be same as the directory where the file is saved. You can set the working directory using one of these ways

- In RStudio along the top bar choose Session > Set Working Directory > Choose Directory

- Use the function `getwd()` to see what the current working directory (wd) is and use `setwd()` to set a working directory. For example
    ```{r rintro-setwd-3, eval=FALSE}
setwd("Your directory")
    ```

Now, if you go to the **Files** tab, you can see all the files in your directory. One tip is to (i) save your .R or .Rmarkdown file and the data set in the **same folder** and then (ii) open a new RStudio window by opening .R or .Rmarkdown file from that folder. This way the default working directory will be the directory your files are stored. It's also easier to manage all your files in one folder.

### Extracting Elements from a Data Frame

You can use the column names of a data frame as defined objects in the **Environment** by attaching the data frame to **R**
```{r rintro-attach}
attach(mydata)
```

For example, the data framw `mydata` has column `Gender`. We can work with this column directly as a saved vector in R.
```{r rintro-gender}
Gender
```

Once you have completed work with the data set, you can detach them from use
```{r rintro-detach}
detach(mydata)
```

If you do not want to attach the data set, you can call the column (variable) using the `$` operator
```{r rintro-dollar}
mydata$Gender
```

::: {.myExercise}
::: {.exercise #exr-rintro-data-set}
How many people are in the `mydata` dataset? What is the sum of their heights?
:::
:::

::: {.empty}
:::

::: {.myNote data-latex=""}
**<ins>Notes:</ins>** To learn more about **R**, visit  [https://libraryguides.mcgill.ca/R](https://libraryguides.mcgill.ca/R).
:::
